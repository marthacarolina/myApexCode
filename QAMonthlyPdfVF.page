<apex:page controller="QAMonthlyController" renderAs="PDF" showHeader="false" action="{!MonthlyQA}">

    <apex:stylesheet value="{!URLFOR($Resource.advancedpdfresource, 'QAReportPDF.css')}"/>
    <table width="100%">
        <tr width="100%">
            <td width="50%" align="left">
                <apex:image value="{!URLFOR($Resource.advancedpdfresource, 'logo.png')}"/>
            </td>
            <td width="50%" align="right">
                <apex:panelGrid columns="1" styleClass="reportinfo">
                    <apex:outputText value="Report Generated by:" />
                    <apex:outputText value="{!$User.FirstName} {!$User.LastName}" />
                    <br />
                    <apex:outputText value="{0,date,yyyy.MM.dd G 'at' HH:mm:ss z}" >
                        <apex:param value="{! NOW() }" />
                    </apex:outputText>
                </apex:panelGrid>
            </td>
        </tr>
    </table>
    <h2>QA Report for {!month}</h2>
    <hr />
    <h3>Total Activity Days this month: {!totalMAD}</h3>
    <h3>Participants attending more than one adventure during the month: {!serialParticipants}</h3>
    <apex:repeat value="{!participants}" var="participant" id="theParticipants">
        <hr class="list" />
        <table width="100%">
            <tr width="100%" class="member">
                <td width ="40%" >
                    <apex:outputText value="Participant: {!participant.Name}" />
                </td>
                <td width = "30%">
                    <apex:outputText value="Total Adventures: {!participant.totCamp}" />
                </td>
                <td width = "30%">
                    <apex:outputText value="Total Activity Days: {!participant.totActDays}" />
                </td>
            </tr>
        </table>
        <hr class="list" />
        <apex:dataTable value="{!participant.adventures}" var="c" id="theTable" headerClass="tablehead"
                        rowClasses="odd,even" style="font-size: 100%; "
                        columnsWidth="300px, 100px, 100px">
            <apex:column>
                <apex:outputText value="Adventure: {!c.Name}"/>
            </apex:column>
            <apex:column >
                <apex:outputText value="Date: {!c.sdate}"/>
            </apex:column>
            <apex:column >
                <apex:outputText value="Activity Days: {!c.ActivityDays}"/>
            </apex:column>
        </apex:dataTable>
    </apex:repeat>
    <hr />
    <h3>Staff Involvement</h3>
    <apex:repeat value="{!staff}" var="st" id="theStaff">
        <hr class="list" />
        <table width="100%">
            <tr width="100%" class="member">
                <td width ="60%" >
                    <apex:outputText value="Staff Member: {!st.Name}" />
                </td>
                <td width = "40%">
                    <apex:outputText value="Total Activities Conducted: {!st.totCamp}" />
                </td>
            </tr>
        </table>
        <apex:dataTable value="{!st.adventures}" var="c" id="theTable" headerClass="tablehead"
                        rowClasses="odd,even" style="font-size: 100%; "
                        columnsWidth="400px, 100px">
            <apex:column style="border: 1px">
                <apex:outputText value="Activity: {!c.Name}"/>
            </apex:column>
            <apex:column >
                <apex:outputText value="Date: {!c.sdate}"/>
            </apex:column>
        </apex:dataTable>
    </apex:repeat>

</apex:page>
